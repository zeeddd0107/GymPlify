<!DOCTYPE html>
<html>
<head>
  <title>Check Admins</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    pre { background: #f5f5f5; padding: 15px; border-radius: 5px; }
    .admin { background: #e3f2fd; padding: 10px; margin: 10px 0; border-radius: 5px; }
  </style>
</head>
<body>
  <h1>Check Admin Users</h1>
  <div id="result">Loading...</div>
  
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getFirestore, collection, query, where, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    // Get your Firebase config from web/src/config/firebase.js
    const firebaseConfig = {
      // PASTE YOUR CONFIG HERE
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function checkAdmins() {
      try {
        const q = query(collection(db, "users"), where("role", "==", "admin"));
        const snapshot = await getDocs(q);

        const resultDiv = document.getElementById('result');
        
        if (snapshot.empty) {
          resultDiv.innerHTML = '<p style="color: red;">No admin users found!</p>';
          return;
        }

        let html = `<h2>Found ${snapshot.size} Admin User(s):</h2>`;
        
        snapshot.forEach((doc) => {
          const data = doc.data();
          html += `
            <div class="admin">
              <strong>Admin ${snapshot.docs.indexOf(doc) + 1}</strong><br>
              <strong>ID:</strong> ${doc.id}<br>
              <strong>Email:</strong> ${data.email || 'N/A'}<br>
              <strong>Display Name:</strong> ${data.displayName || data.name || 'N/A'}<br>
              <strong>Role:</strong> ${data.role}<br>
            </div>
          `;
        });

        html += `
          <h3>Explanation:</h3>
          <p>✅ You have <strong>${snapshot.size} admin user(s)</strong></p>
          <p>✅ When a user requests a subscription, the system creates <strong>${snapshot.size} notification(s)</strong> - one for each admin</p>
          <p>✅ This is correct! Each admin can mark their notification as read/unread independently.</p>
        `;

        resultDiv.innerHTML = html;

        console.log(`Found ${snapshot.size} admin users:`, snapshot.docs.map(d => ({
          id: d.id,
          email: d.data().email,
          name: d.data().displayName || d.data().name
        })));
        
      } catch (error) {
        document.getElementById('result').innerHTML = 
          `<p style="color: red;">Error: ${error.message}</p>
           <p>Make sure you've added your Firebase config above!</p>`;
        console.error('Error:', error);
      }
    }

    checkAdmins();
  </script>
</body>
</html>

